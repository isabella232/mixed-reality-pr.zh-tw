---
title: 座標系統
description: 用來建立內建、站上、房間規模和世界規模混合現實體驗的空間座標系統。
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: 座標系統、空間座標系統、僅限方向、固定規模、固定規模、室內規模、世界規模、360度、坐、上、房間、世界、縮放、位置、方向、固定、附加、階段、錨點、空間錨點、全球鎖定、世界鎖定、內文鎖定、內文鎖定、界限、持續性、共用、追蹤遺失、雲端空間錨點、虛擬實境耳機、HoloLens、MRTK、混合現實工具組
ms.openlocfilehash: 42efc1444c030641ad215501c4a12d6315ea9857
ms.sourcegitcommit: d340303cda71c31e6c3320231473d623c0930d33
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/01/2021
ms.locfileid: "97848024"
---
# <a name="coordinate-systems"></a>座標系統

在其核心中，混合現實應用程式 [會在您的世界中放置](../discover/hologram.md) 全像真實物件的全像音效。 這牽涉到在世界各地有意義的地方精確定位及定位這些全像全球，無論是世界的實體室或是您所建立的虛擬領域。 Windows 提供各種真實全局座標系統來表示幾何，也就是所謂的 **空間座標系統**。 您可以使用空間座標系統來因應全息圖位置、方向、 [注視](gaze-and-commit.md) 光線或 [手位置](hands-and-tools.md)的原因。

<br>

<iframe width="940" height="530" src="https://www.youtube.com/embed/TneGSeqVAXQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## <a name="device-support"></a>裝置支援

<table>
    <colgroup>
    <col width="40%" />
    <col width="20%" />
    <col width="20%" />
    <col width="20%" />
    </colgroup>
    <tr>
        <td><strong>功能</strong></td>
        <td><a href="https://docs.microsoft.com/hololens/hololens1-hardware"><strong>HoloLens (第 1 代)</strong></a></td>
        <td><a href="https://docs.microsoft.com/hololens/hololens2-hardware"><strong>HoloLens 2</strong></td>
        <td><a href="https://docs.microsoft.com/windows/mixed-reality/immersive-headset-hardware-details"><strong>沉浸式頭戴裝置</strong></a></td>
    </tr>
     <tr>
        <td><a href="coordinate-systems.md#stationary-frame-of-reference">固定的參考框架</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#attached-frame-of-reference">附加的參考框架</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#stage-frame-of-reference">參考的階段框架</a></td>
        <td>尚不支援</td>
        <td>尚不支援</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#spatial-anchors">空間錨點</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="spatial-mapping.md">空間對應</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>❌</td>
    </tr>
    <tr>
        <td><a href="scene-understanding.md">場景理解</a></td>
        <td>❌</td>
        <td>✔️</td>
        <td>❌</td>
    </tr>
</table>

## <a name="mixed-reality-experience-scales"></a>混合現實體驗規模調整

您可以針對各種使用者體驗設計混合現實應用程式，從使用耳機方向的360度影片檢視器，到使用空間對應和空間錨點的全世界規模應用程式和遊戲：

<br>

| 體驗規模 | 規格需求 | 範例體驗 | 
|----------|----------|----------|
|  **僅限方向** |  **耳機方向** (引力對齊的)  |  360°影片檢視器 | 
|  **固定規模** |  上方加上以零位置為依據的 **耳機位置** |  賽車遊戲或空間模擬器 | 
|  **長期調整** |  上方加上 **階段樓層來源** |  您已備妥和淡出的行動遊戲  | 
|  **會議室規模** |  上方加上 **階段界限多邊形** |  您逐步解說謎題的拼圖遊戲 | 
|  **全球規模** |  **空間錨點** (，通常是 [空間對應](spatial-mapping.md))  |  敵人來自您真實牆的遊戲，例如 [RoboRaid](https://www.microsoft.com/p/roboraid/9nblggh5fv3j) | 

上述經驗調整會遵循「嵌套玩偶」模型。 Windows Mixed Reality 的主要設計原則是指定的耳機，支援針對目標體驗規模和所有較小規模的應用程式所建立的應用程式：

<br>

| 6DOF 追蹤 | 已定義樓層 | 360°追蹤 | 已定義界限 | 空間錨點 | 最大體驗 | 
|----------|----------|----------|----------|----------|----------|
|  否 |  - |  - |  - |  - |  **僅限方向** | 
|  **是** |  否 |  - |  - |  - |  **坐** | 
|  **是** |  **是** |  否 |  - |  - |  **長期向前** | 
|  **是** |  **是** |  **是** |  否 |  - |  **長期-360 °** | 
|  **是** |  **是** |  **是** |  **是** |  否 |  **會議室** | 
|  **是** |  **是** |  **是** |  **是** |  **是** |  **World** | 

HoloLens 尚未支援參考的階段框架。 HoloLens 上的房間規模應用程式目前需要使用 [空間對應](spatial-mapping.md) 或 [場景理解](scene-understanding.md) ，以找出使用者的樓層和牆。

## <a name="spatial-coordinate-systems"></a>空間座標系統

所有3D 圖形應用程式都會使用 [笛卡兒座標系統](https://docs.microsoft.com/windows/uwp/graphics-concepts/coordinate-systems) 來表示虛擬物件的位置和方向。 這些座標系統會建立3個垂直軸，以放置物件： X、Y 和 Z 軸。

在 [混合的現實](../discover/mixed-reality.md)情況下，您的應用程式會有虛擬和實體座標系統的原因。 Windows 呼叫的座標系統在實體世界中具有真正意義的 **空間座標系統**。

空間座標系統表示其座標值（以量值為單位）。 這表示，在混合現實中轉譯時，物件會在 X、Y 或 Z 軸之間分開顯示2個計量。 知道這一點，您可以輕鬆地以真實世界的規模呈現物件和環境。

一般來說，笛卡兒座標系統可以是右手或左手。 Windows 上的空間座標系統一律是右手的，這表示正 X 軸朝右，右 Y 軸會向上 (對齊引力) ，而正 Z 軸會指向您。

在這兩種座標系統中，正 X 軸指向右邊，Y 軸則會向上點。 不同之處在于正面 Z 軸是否朝向您的距離。 請記住，正 Z 軸指向的方向是指向正 X 方向的手指，然後將它們 curling 為正 Y 方向。 您的拇指點方向（朝向或遠離您的方向）是該座標系統的正 Z 軸點方向。

## <a name="building-an-orientation-only-or-seated-scale-experience"></a>打造僅限方向或內部規模的體驗

「全像」轉譯的 [關鍵是在](../develop/platform-capabilities-and-apis/rendering.md) 使用者四處移動時，變更應用程式的每個畫面格的影像，以符合其預測的 head 動作。 您可以使用 **固定的參考框架**，建立符合使用者頭部定位和前端方向變更的內部 **規模體驗**。

有些內容必須忽略標頭位置的更新，並在選擇的標題上保持固定，並一律與使用者的距離保持固定。 主要範例是360度的影片：由於影片是從單一固定的觀點來捕捉的，因此會損毀讓視圖位置根據內容移動的假像，即使在使用者尋找時，視圖方向也隨之改變。 您可以使用 **附加的參考框架** 來建立 **僅限方向的體驗**。

### <a name="stationary-frame-of-reference"></a>固定的參考框架

靜止的參考框架所提供的座標系統，會根據世界的情況，盡可能將物件的位置保持在更穩定的位置，同時遵守使用者的標頭位置的變更。

若為遊戲引擎（例如 [Unity](https://unity3d.com/)）中的內部規模體驗，固定的參考框架會定義引擎的「世界原點」。 放在特定全局座標的物件會使用參考的靜止框架，在真實世界中使用這些相同的座標來定義其位置。 即使在使用者四處解說的情況下，仍在世界各地的內容，也稱為 **全球鎖定** 的內容。

應用程式通常會在啟動時建立一個靜止的參考框架，並在整個應用程式的存留期內使用其座標系統。 作為 Unity 中的應用程式開發人員，您可以直接根據原點開始放置內容，這會是使用者的初始前端位置和方向。 如果使用者移至新的位置，並想要繼續其內部規模的體驗，您可以在該位置 recenter 世界原點。

經過一段時間之後，當系統深入瞭解使用者的環境時，它可能會判斷真實世界中不同點之間的距離，比系統先前所認為的還要短或更長。 如果您在 HoloLens 上轉譯應用程式的靜止框架，而使用者穿梭超過5計量範圍的範圍，則您的應用程式可能會在觀察到的全像全像地區之間觀察到漂移。 如果您的體驗讓使用者 wandering 超過5個計量，您就會建立 [全球規模的體驗](#building-a-world-scale-experience)，這將需要其他技術來維持全像下圖的穩定性。

### <a name="attached-frame-of-reference"></a>附加的參考框架

當應用程式第一次建立框架時，連結的參考框架會隨著使用者四處移動，並提供固定的標題。 這可讓使用者輕鬆地查看位於該參考框架內的內容。 以這種使用者相關的方式轉譯的內容稱為「 **主體鎖定** 內容」。

當耳機無法找出世界中的位置時，連結的參考框架會提供唯一的座標系統，可用來轉譯全像。 這非常適合顯示回溯 UI，讓使用者知道他們的裝置無法在世界中找到它們。 已上延展或更高的應用程式應該包含僅限方向的回復，以協助使用者再次開始使用與 [混合現實首頁](../discover/navigating-the-windows-mixed-reality-home.md)中所顯示的 UI 類似的 UI。

## <a name="building-a-standing-scale-or-room-scale-experience"></a>打造大規模或房間規模的體驗

若要超越在沉浸式耳機上的放大規模並打造 **大規模的體驗**，您可以使用階段式 **的參考框架**。

若要提供 **會議室規模的體驗**，讓使用者在其預先定義的5計量界限內四處討論，您也可以檢查 **階段界限** 。

### <a name="stage-frame-of-reference"></a>參考的階段框架

當您第一次設定沉浸式耳機時，使用者會定義一個 **階段**，代表他們將遇到混合現實的空間。 階段會以最少的方式定義 **階段原點**，這是一個空間座標系統，在使用者選擇的樓層位置，以及要使用裝置的前進方向。 藉由將內容放在 Y = 0 樓層平面的這個階段座標系統中，您可以確保您的全像是在使用者的地面上輕鬆地出現，並為使用者提供 **大規模的體驗**。

### <a name="stage-bounds"></a>階段界限

使用者也可以選擇性地定義 **階段界限**，也就是他們在空間內清除以在混合現實中四處移動的區域。 如果是，應用程式可以使用這些界限來建立 **房間規模的體驗**，以確保所有的全像影像都一律放在使用者可以觸及的位置。

由於參考的階段框架提供單一固定座標系統，以放置樓層相關內容，因此是移植針對虛擬實境耳機開發之大規模和會議室規模應用程式的最簡單途徑。 不過，就像這些 VR 平臺一樣，單一座標系統只能在大約5個度量 (16 英尺) 直徑的最穩定內容，然後拉杆 arm 效果會導致在系統調整的情況下，將內容從中心移到最顯著的方向。 若要超越5個計量，則需要空間錨點。

## <a name="building-a-world-scale-experience"></a>打造全球規模的體驗

HoloLens 可提供真正的 **全球規模體驗** ，讓使用者穿梭超過5個計量。 若要打造全球規模的應用程式，您需要新的技術，而不是用於房間規模的體驗。

### <a name="why-a-single-rigid-coordinate-system-cannot-be-used-beyond-5-meters"></a>為何單一固定座標系統無法使用超過5個計量

現在，在撰寫遊戲、資料視覺效果應用程式或虛擬實境應用程式時，一般的方法是建立一個絕對全局座標系統，讓所有其他座標都能可靠地對應回。 在該環境中，您一律可以尋找穩定的轉換，以定義該世界中任何兩個物件之間的關聯性。 如果您未移動這些物件，其相對轉換一律會維持不變。 這種全域座標系統在轉譯單純的虛擬世界（您事先知道所有幾何）時非常好用。 現今的房間規模的 VR 應用程式通常會建立這種絕對房間縮放座標系統及其原點。

相反地，非網路共用的混合現實裝置（例如 HoloLens）對世界有動態的感應器驅動理解，會持續調整使用者周圍環境的知識，因為它們會在整個建築樓層中逐步進行許多計量。 在全球規模的體驗中，如果您將所有的全像放在單一固定座標系統中，則這些全像是以世界或彼此為基礎的全像時間，都必須漂移。

例如，耳機目前可能會認為世界上有兩個位置彼此之間有4個度量，然後在稍後調整該瞭解，並瞭解這些位置其實是3.9 計量。 如果這些全息片一開始在單一固定座標系統中放置4個計量，則其中一個會從真實世界一直顯示0.1 計量。

### <a name="spatial-anchors"></a>空間錨點

Windows Mixed Reality 解決上一節所述的問題，可讓您建立 [空間錨點](spatial-anchors.md) ，以標記使用者在世界上放置全像的重要點。 空間錨點代表系統在一段時間中應該於真實世界中追蹤的一個重要時間點。

當裝置學習到世界時，這些空間錨點可以視需要調整其位置，以確保每個錨點都能精確地根據真實世界放置位置。 藉由將空間錨點放在使用者放置全息圖，然後根據其空間錨點放置該全像影像的位置，您可以確保全像使用者在數十個計量上漫遊的時候，全像是可維持最佳的穩定性。

這會持續調整以另一個為基礎的空間錨點，這是座標系統與空間錨點和固定框架參考之間的主要差異：

* 放在參考的靜止框架中的全像投影，全都保持彼此的固定關聯性。 不過，當使用者逐步進行長距離時，該框架的座標系統可能會在世界上漂移，以確保使用者旁的全息型顯示穩定。

* 放在參考階段框架中的全像投影，也會保留彼此的固定關聯性。 相對於固定框架，階段框架一律會根據其定義的實體原點維持固定狀態。 不過，在階段座標系統中轉譯的內容超過其5計量界限的內容，只會在使用者位於該界限內時，才會顯示穩定。

* 使用一個空間錨點放置的全像影像可能會以使用另一個空間錨點的全像投影為依據。 這可讓 Windows 改善對每個空間錨點位置的瞭解，即使某個錨點需要自行調整，而另一個錨點需要向右調整也是一樣。

相對於固定的參考框架，其一律會針對接近使用者的穩定性進行優化，參考和空間錨點的階段框架可確保其來源的穩定性。 這可協助這些全像一段時間的全像投影一樣，但這也表示從其座標系統的原點呈現的全像是太遠的空間，將會遇到越來越多的嚴重杠杆-arm 效果。 這是因為對於階段或錨點的位置和方向進行小調整，會隨著距離錨點的距離而放大。 

理想的經驗法則是確保您根據距離空間錨點座標系統所轉譯的任何事物，都在其原點的3個計量範圍內。 針對附近的階段原點，轉譯遠距內容是正常的，因為任何增加的位置錯誤將只會影響不會在使用者觀點中移動的小型全像影像。

### <a name="spatial-anchor-persistence"></a>空間錨點持續性

空間錨點也可讓您的應用程式在您的應用程式暫停或裝置關閉之後，記住重要的位置。

您可以將應用程式所建立的空間錨點儲存到磁片，然後稍後再將它們保存到應用程式的 **空間錨點存放區**，以便稍後再重新載入。 儲存或載入錨點時，您會提供對應用程式有意義的字串金鑰，以便稍後識別錨點。 請將此金鑰視為錨點的檔案名。 如果您想要將其他資料與該錨點產生關聯，例如使用者放在該位置的3D 模型，請將其儲存至您應用程式的本機儲存體，並將它與您選擇的金鑰建立關聯。

藉由將錨點保存到存放區，您的使用者可以將個別的全像是放置在一起，或放置一個工作區，讓應用程式用來放置其各種不同的全像影像，然後在您的應用程式的許多用途之後，于預期的位置找到

您也可以使用 <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure 空間錨點</a> ，在 HoloLens、IOS 和 Android 裝置上進行非同步全像保存。  藉由共用長期雲端空間錨點，即使這些裝置不會同時存在，多個裝置也可以觀察經過一段時間的相同保存全息圖。

### <a name="spatial-anchor-sharing"></a>空間錨點共用

您的應用程式也可以與其他裝置即時共用空間錨點，以允許即時共用體驗。

藉由使用 <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure 空間錨點</a>，您的應用程式可以跨多個 HoloLens、IOS 和 Android 裝置共用空間錨點。 透過讓每個裝置使用同一個空間錨點轉譯全像投影，所有使用者將會看到全像投影出現在真實世界中的相同位置。

## <a name="avoid-head-locked-content"></a>避免標頭鎖定的內容

我們強烈建議您不要轉譯標頭鎖定的內容，這會在顯示 (（例如抬頭顯示器) ）中維持固定位置。 一般情況下，使用者不會覺得標頭鎖定的內容，也不像世界的自然部分。

永遠鎖定的內容通常應取代為連接到使用者或放在世界本身的全像影像。 例如，資料 [指標](cursors.md) 通常應該會推入至世界中，並自然地調整以反映物件在使用者的注視下的位置和距離。

## <a name="handling-tracking-errors"></a>處理追蹤錯誤

在某些環境中（例如深色走廊），耳機可能無法在世界中正確地找到它本身。 如果未正確處理，這可能會導致全像全像，不會顯示或顯示在不正確的位置。 我們現在會討論發生這種情況的情況、其對使用者體驗的影響，以及最能有效處理這種情況的秘訣。

### <a name="headset-cant-track-due-to-insufficient-sensor-data"></a>耳機無法追蹤感應器資料不足的原因

有時候，耳機的感應器無法找出耳機的位置。 這會在符合下列情形時發生：

* 房間很暗
* 如果感應器是由頭髮或手所涵蓋
* 如果周圍的材質沒有足夠的材質。

發生這種情況時，耳機將無法以足夠的精確度來追蹤其位置，以呈現世界鎖定的全像。 您無法找出空間錨點、固定框架或階段框架是否以裝置為基礎。 不過，您仍然可以在附加的參考框架中轉譯主體鎖定的內容。

您的應用程式應該告訴使用者如何取得位置追蹤，以轉譯一些可描述某些秘訣的回溯主體鎖定內容，例如發現感應器並開啟更多燈光。

### <a name="headset-tracks-incorrectly-due-to-dynamic-changes-in-the-environment"></a>由於環境中的動態變更，耳機追蹤不正確

如果環境中有大量的動態變更，例如許多人在房間內四處流覽，則裝置無法正常追蹤。 在此情況下，當裝置嘗試在此動態環境中追蹤自己時，全像移動可能會跳躍或漂移。 如果您遇到這種情況，建議您在較不動態的環境中使用裝置。

### <a name="headset-tracks-incorrectly-because-the-environment-has-changed-significantly-over-time"></a>耳機軌不正確，因為環境在一段時間內大幅改變

當您在家具、牆壁 hangings 等的環境中開始使用耳機時，有可能會從其原始位置中看到一些可能的移動。 當使用者在新的空間中移動時，較舊的全像投影也可能會跳到，因為系統對您空間的瞭解已不再成立。 系統接著會嘗試重新對應環境，同時也嘗試協調房間的功能。 在此案例中，建議使用者在未于預期的情況下，取代在世界各地釘選的全像影像。

### <a name="headset-tracks-incorrectly-due-to-identical-spaces-in-an-environment"></a>因為環境中的空間相同，所以耳機軌跡不正確

有時候，home 或其他空間可能有兩個相同的區域。 例如，兩個相同的會議室、兩個相同的角落區域、兩個完全相同的海報，涵蓋裝置的視圖欄位。 在這種情況下，裝置可能會在相同元件之間取得混淆，並將它們標示為其內部標記法中的相同部分。 這可能會導致某些區域的全像影像出現在其他位置。 裝置可能會開始因為環境的內部表示已損毀而無法經常發生追蹤。 在此情況下，建議您重設系統的環境理解。 重設地圖會導致所有空間錨點放置遺失。 這會導致耳機在環境的唯一區域中妥善追蹤。 但是，如果裝置再次在相同區域之間混淆，可能會發生此問題。

## <a name="see-also"></a>請參閱
* [GDC 2017 呈現空間座標系統和全像攝影轉譯](https://channel9.msdn.com/events/GDC/GDC-2017/GDC2017-008)
* [Unity 中的座標系統](../develop/unity/coordinate-systems-in-unity.md)
* [DirectX 中的座標系統](../develop/native/coordinate-systems-in-directx.md)
* [空間錨點](spatial-anchors.md)
* [混合實境中的共用體驗](../develop/platform-capabilities-and-apis/shared-experiences-in-mixed-reality.md)
* <a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a>
* [案例研究 - 在實境中的的透視技術](../out-of-scope/case-study-looking-through-holes-in-your-reality.md)
